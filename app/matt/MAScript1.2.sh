#!/bin/bash 
hadoop jar ../../usr/local/hadoop/share/hadoop/tools/lib/hadoop-streaming-2.8.0.jar -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D stream.map.output.field.separator=, -D stream.num.map.output.key.fields=6 -D map.output.key.field.separator=, -D mapred.text.key.comparator.options='-k1,1 -k2,2n -k3,3n' -mapper marketanalysis/app/stage1.2/map_pass.py -reducer marketanalysis/app/stage1.2/reduce.py -input "stage1.2sorted/part-00000" -output "stage1.2results" && hdfs dfs -cat stage1.2results/part-00000 